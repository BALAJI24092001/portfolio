<!DOCTYPE html>
<html lang="en" dir="auto">

<head><link rel="icon" type="" href="logo.png">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="robots" content="index, follow">
<title>Database Warehousing | BALAJI</title>
<meta name="keywords" content="CS">
<meta name="description" content="I computing, a data warehouse, also known as an enterprise data warehouse, is a system used for reporting and data analysis and is considered a core component of data analysis.
Data warehouses are central repositories of integrated data from one or more different sources. They store current and historical data in one single place.
We use databases for transaction purposes, and the historical data of these transactions and it&rsquo;s previous states are stored in this data warehouses.">
<meta name="author" content="">
<link rel="canonical" href="balaji24092001/post/database-warehousing/">
<link crossorigin="anonymous" href="balaji24092001/assets/css/stylesheet.9de45e225101e4f99701d2b68fc6b8a1ef6027928be6391fa15bf7f56326c909.css" integrity="sha256-neReIlEB5PmXAdK2j8a4oe9gJ5KL5jkfoVv39WMmyQk=" rel="preload stylesheet" as="style">
<link rel="icon" href="balaji24092001/favicon.ico">
<link rel="icon" type="image/png" sizes="16x16" href="balaji24092001/favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="balaji24092001/favicon-32x32.png">
<link rel="apple-touch-icon" href="balaji24092001/apple-touch-icon.png">
<link rel="mask-icon" href="balaji24092001/safari-pinned-tab.svg">
<meta name="theme-color" content="#2e2e33">
<meta name="msapplication-TileColor" content="#2e2e33">
<link rel="alternate" hreflang="en" href="balaji24092001/post/database-warehousing/">
<noscript>
    <style>
        #theme-toggle,
        .top-link {
            display: none;
        }

    </style>
    <style>
        @media (prefers-color-scheme: dark) {
            :root {
                --theme: rgb(29, 30, 32);
                --entry: rgb(46, 46, 51);
                --primary: rgb(218, 218, 219);
                --secondary: rgb(155, 156, 157);
                --tertiary: rgb(65, 66, 68);
                --content: rgb(196, 196, 197);
                --code-block-bg: rgb(46, 46, 51);
                --code-bg: rgb(55, 56, 62);
                --border: rgb(51, 51, 51);
            }

            .list {
                background: var(--theme);
            }

            .list:not(.dark)::-webkit-scrollbar-track {
                background: 0 0;
            }

            .list:not(.dark)::-webkit-scrollbar-thumb {
                border-color: var(--theme);
            }
        }

    </style>
</noscript>


































<script
  type="text/javascript"
  src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"
></script>

<script type="text/x-mathjax-config">
  MathJax.Hub.Config({
    tex2jax: {
      inlineMath: [['$','$'], ['\\(','\\)']],
      displayMath: [['$$','$$'], ['\[','\]']],
      processEscapes: true,
      processEnvironments: true,
      skipTags: ['script', 'noscript', 'style', 'textarea', 'pre'],
      TeX: { equationNumbers: { autoNumber: "AMS" },
           extensions: ["AMSmath.js", "AMSsymbols.js"] }
    }
  });
</script>












<meta property="og:url" content="balaji24092001/post/database-warehousing/">
  <meta property="og:site_name" content="BALAJI">
  <meta property="og:title" content="Database Warehousing">
  <meta property="og:description" content="I computing, a data warehouse, also known as an enterprise data warehouse, is a system used for reporting and data analysis and is considered a core component of data analysis.
Data warehouses are central repositories of integrated data from one or more different sources. They store current and historical data in one single place.
We use databases for transaction purposes, and the historical data of these transactions and it’s previous states are stored in this data warehouses.">
  <meta property="og:locale" content="en-us">
  <meta property="og:type" content="article">
    <meta property="article:section" content="post">
    <meta property="article:tag" content="CS">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Database Warehousing">
<meta name="twitter:description" content="I computing, a data warehouse, also known as an enterprise data warehouse, is a system used for reporting and data analysis and is considered a core component of data analysis.
Data warehouses are central repositories of integrated data from one or more different sources. They store current and historical data in one single place.
We use databases for transaction purposes, and the historical data of these transactions and it&rsquo;s previous states are stored in this data warehouses.">


<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "BreadcrumbList",
  "itemListElement": [
    {
      "@type": "ListItem",
      "position":  1 ,
      "name": "Posts",
      "item": "balaji24092001/post/"
    }, 
    {
      "@type": "ListItem",
      "position":  2 ,
      "name": "Database Warehousing",
      "item": "balaji24092001/post/database-warehousing/"
    }
  ]
}
</script>
<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "BlogPosting",
  "headline": "Database Warehousing",
  "name": "Database Warehousing",
  "description": "I computing, a data warehouse, also known as an enterprise data warehouse, is a system used for reporting and data analysis and is considered a core component of data analysis.\nData warehouses are central repositories of integrated data from one or more different sources. They store current and historical data in one single place.\nWe use databases for transaction purposes, and the historical data of these transactions and it\u0026rsquo;s previous states are stored in this data warehouses.\n",
  "keywords": [
    "CS"
  ],
  "articleBody": "I computing, a data warehouse, also known as an enterprise data warehouse, is a system used for reporting and data analysis and is considered a core component of data analysis.\nData warehouses are central repositories of integrated data from one or more different sources. They store current and historical data in one single place.\nWe use databases for transaction purposes, and the historical data of these transactions and it’s previous states are stored in this data warehouses.\nUsing the process called ETL, the data from the databases are converted and stored in data warehouses. From the data warehouse we get the meta data for analysis, visualization and for additional business intelligence insights.\nA data warehouse is a repository (data and metadata) that contains integrated, cleansed, and reconciled data from disparate sources for decision support applications, with an emphasis on online analytical processing.\nIntegrated: A data warehouse integrates data from multiple data sources. For example, source A and source B may have different ways of identifying a product, but in a data warehouse, there will be only a single way of identifying a product. Time-Variant: Historical data is kept in a data warehouse. For example, one can retrieve data from 3 months, 6 months, 12 months, or even older data from a data warehouse. This contrasts with a transactions system, where often only the most recent data is kept. For example, a transaction system may hold the most recent address of a customer, where a data warehouse can hold all addresses associated with a customer. Non-volatile: Once data is in the data warehouse, it will not change. So, historical data in a data warehouse should never be altered. Data Warehouse Architecture ETL E: Extract (Extraction of data from different sources) T: Transform (Clean and convert data into more approprioate structure to store in the warehouse) L: Load\nThree-phase process where data is extracted, transformed and loaded into an output data container. Usually done by application software but can be done manually also.\nUpdates in a database are very frequent.\nExtract: The first stage in the ETL process is to extract data from various sources such as transactional systems, spreadsheets, and flat files. In this step, data from various source systems is extracted which can be in various formats like relational databases, No SQL, XML, and flat files into the staging area. It is important to extract the data from various source systems and store it into the staging area first and not directly into the data warehouse because the extracted data is in various formats and can be corrupted also. Hence loading it directly into the data warehouse may damage it and rollback will be much more difficult. Therefore, this is one of the most important steps of ETL process\nTransform: In this stage, the extracted data is transformed into a format that is suitable for loading into the data warehouse. In this step, a set of rules or functions are applied on the extracted data to convert it into a single standard format. It may involve following processes/tasks:\nFiltering – loading only certain attributes into the data warehouse. Cleaning – filling up the NULL values with some default values, mapping U.S.A, United States, and America into USA, etc. Joining – joining multiple attributes into one. Splitting – splitting a single attribute into multiple attributes. Sorting – sorting tuples on the basis of some attribute (generally key-attribute). Load: After the data is transformed, it is loaded into the data warehouse. This step involves creating the physical data structures and loading the data into the warehouse. In this step, the transformed data is finally loaded into the data warehouse. Sometimes the data is updated by loading into the data warehouse very frequently and sometimes it is done after longer but regular intervals. The rate and period of loading solely depend on the requirements and varies from system to system.\nETL is used if the whole process is outlet to a different organization, so the data is not directly loaded into the warehouse, rather it is kept in a staging area where is can be scrutinized for saftey issues and then loaded into the warehouse. ELT is used if the company itself is handling all the work. Here the data is directly loaded into the warehouse and then transformed and stored in the warehouse.\nData Warehouse Models Enterprise warehouse:\nAn enterprise warehouse collects all of the information about subjects spanning the entire organization. It provides corporate-wide data integration, usually from one or more operational systems or external information providers, and is cross-functional in scope. It typically contains detailed data aswell as summarized data, and can range in size from a few gigabytes to hundreds of gigabytes, terabytes, or beyond. An enterprise data warehouse may be implemented on traditional mainframes, computer superservers, or parallel architecture platforms. It requires extensive business modeling and may take years to design and build. Data mart:\nA data mart contains a subset of corporate-wide data that is of value to a specific group of users. The scope is confined to specific selected subjects. For example,a marketing data mart may confine its subjects to customer, item, and sales. The data contained in data marts tend to be summarized. Data marts are usually implemented on low-cost departmental servers that are UNIX/LINUX or Windows-based. The implementation cycle of a data mart is more likely to be measured in weeks rather than months or years. However, it may involve complex integration in the long run if its design and planning were not enterprise-wide. Depending on the source of data, data marts can be categorized as independent or dependent. Independent data marts are sourced from data captured from one or more operational systems or external information providers, or from data generated locally within a particular department or geographic area. Dependent data marts are sourced directly from enterprise data warehouses. Virtual warehouse:\nA virtual warehouse is a set of views over operational databases. For efficient query processing, only some of the possible summary views may be materialized. A virtual warehouse is easy to build but requires excess capacity on operational database servers. OLTP (Online Transaction Processing)\nType of data processing that consists of executing a number of transactions occuring currently. Eg; Online banking, online shopping etc…\nOLAP (Online Analytical Processing)\nSoftware for performing multi-dimensional analysis at high speeds on large volumes of data from a data warehouse, data mart or some other unified , centralized data store.\nOLTP Systems OLAP Systems Enable the real-time execution of large numbers of database transactions by large numbers of people. Usually involve querying many records (even all records) in a database for analytical purposes. Require lightning-fast response times Require response times that are orders of magnitude slower than those required by OLTP. Modify small amounts of data frequently and usually involve a balance of reads and writes. Do not modify data at all; workloads are usually read-intensive. Use indexed data to improve response times Store data in columnar format to allow easy access to large numbers of records. Require frequent or concurrent database backups Require far less frequent database backup. Require relatively little storage space Typically have significant storage space requirements because they store large amounts of historical data. Usually run simple queries involving just one or a few records Run complex queries involving large numbers of records. Data Warehouse Schema Star Schema Snowflake Schema Fact Constellation Schema (Galaxy Schema) ",
  "wordCount" : "1231",
  "inLanguage": "en",
  "datePublished": "0001-01-01T00:00:00Z",
  "dateModified": "0001-01-01T00:00:00Z",
  "mainEntityOfPage": {
    "@type": "WebPage",
    "@id": "balaji24092001/post/database-warehousing/"
  },
  "publisher": {
    "@type": "Organization",
    "name": "BALAJI",
    "logo": {
      "@type": "ImageObject",
      "url": "balaji24092001/favicon.ico"
    }
  }
}
</script>
</head>

<body class="" id="top">
<script>
    if (localStorage.getItem("pref-theme") === "dark") {
        document.body.classList.add('dark');
    } else if (localStorage.getItem("pref-theme") === "light") {
        document.body.classList.remove('dark')
    } else if (window.matchMedia('(prefers-color-scheme: dark)').matches) {
        document.body.classList.add('dark');
    }

</script>

<header class="header">
    <nav class="nav">
        <div class="logo">
            <a href="balaji24092001/" accesskey="h" title="BALAJI (Alt + H)">BALAJI</a>
            <div class="logo-switches">
                <button id="theme-toggle" accesskey="t" title="(Alt + T)">
                    <svg id="moon" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24"
                        fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                        stroke-linejoin="round">
                        <path d="M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"></path>
                    </svg>
                    <svg id="sun" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24"
                        fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                        stroke-linejoin="round">
                        <circle cx="12" cy="12" r="5"></circle>
                        <line x1="12" y1="1" x2="12" y2="3"></line>
                        <line x1="12" y1="21" x2="12" y2="23"></line>
                        <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
                        <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
                        <line x1="1" y1="12" x2="3" y2="12"></line>
                        <line x1="21" y1="12" x2="23" y2="12"></line>
                        <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
                        <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
                    </svg>
                </button>
            </div>
        </div>
        <ul id="menu">
            <li>
                <a href="balaji24092001/balaji24092001/search/" title="Search (Alt &#43; /)" accesskey=/>
                    <span>Search</span>
                </a>
            </li>
            <li>
                <a href="balaji24092001/balaji24092001/categories/" title="Categories">
                    <span>Categories</span>
                </a>
            </li>
            <li>
                <a href="balaji24092001/balaji24092001/tags/" title="Tags">
                    <span>Tags</span>
                </a>
            </li>
            <li>
                <a href="balaji24092001/balaji24092001/projects/" title="Projects">
                    <span>Projects</span>
                </a>
            </li>
        </ul>
    </nav>
</header>
<main class="main">

<article class="post-single">
  <header class="post-header">
    
    <h1 class="post-title entry-hint-parent">
      Database Warehousing
    </h1>
    <div class="post-meta">6 min

</div>
  </header> <div class="toc">
    <details >
        <summary accesskey="c" title="(Alt + C)">
            <span class="details">Table of Contents</span>
        </summary>

        <div class="inner"><ul>
                <li>
                    <a href="#data-warehouse-architecture" aria-label="Data Warehouse Architecture">Data Warehouse Architecture</a></li>
                <li>
                    <a href="#etl" aria-label="ETL">ETL</a></li>
                <li>
                    <a href="#data-warehouse-models" aria-label="Data Warehouse Models">Data Warehouse Models</a></li>
                <li>
                    <a href="#data-warehouse-schema" aria-label="Data Warehouse Schema">Data Warehouse Schema</a>
                </li>
            </ul>
        </div>
    </details>
</div>

  <div class="post-content"><p>I computing, a data warehouse, also known as an enterprise data warehouse, is a system used for reporting and data analysis and is considered a core component of data analysis.</p>
<p>Data warehouses are central repositories of integrated data from one or more different sources. They store current and historical data in one single place.</p>
<p>We use databases for transaction purposes, and the historical data of these transactions and it&rsquo;s previous states are stored in this data warehouses.</p>
<p>Using the process called ETL, the data from the databases are converted and stored in data warehouses. From the data warehouse we get the meta data for analysis, visualization and for additional business intelligence insights.</p>
<p>A data warehouse is a repository (data and metadata) that contains integrated, cleansed, and reconciled data from disparate sources for decision support applications, with an emphasis on online analytical processing.</p>
<ul>
<li><strong>Integrated</strong>: A data warehouse integrates data from multiple data sources. For example, source A and source B may have different ways of identifying a product, but in a data warehouse, there will be only a single way of identifying a product.</li>
<li><strong>Time-Variant</strong>: Historical data is kept in a data warehouse. For example, one can retrieve data from 3 months, 6 months, 12 months, or even older data from a data warehouse. This contrasts with a transactions system, where often only the most recent data is kept. For example, a transaction system may hold the most recent address of a customer, where a data warehouse can hold all addresses associated with a customer.</li>
<li><strong>Non-volatile</strong>: Once data is in the data warehouse, it will not change. So, historical data in a data warehouse should never be altered.</li>
</ul>
<h2 id="data-warehouse-architecture">Data Warehouse Architecture<a hidden class="anchor" aria-hidden="true" href="#data-warehouse-architecture">#</a></h2>
<p><img alt="Data Warehouse Architecture" loading="lazy" src="./img/DWHA.png"></p>
<h2 id="etl">ETL<a hidden class="anchor" aria-hidden="true" href="#etl">#</a></h2>
<p>E: Extract (Extraction of data from different sources) <!-- raw HTML omitted -->
T: Transform (Clean and convert data into more approprioate structure to store in the warehouse) <!-- raw HTML omitted -->
L: Load<!-- raw HTML omitted --></p>
<p>Three-phase process where data is extracted, transformed and loaded into an output data container. Usually done by application software but can be done manually also.</p>
<blockquote>
<p>Updates in a database are very frequent.</p></blockquote>
<p><strong>Extract</strong>: The first stage in the ETL process is to extract data from various sources such as transactional systems, spreadsheets, and flat files. In this step, data from various source systems is extracted which can be in various formats like relational databases, No SQL, XML, and flat files into the staging area. It is important to extract the data from various source systems and store it into the staging area first and not directly into the data warehouse because the extracted data is in various formats and can be corrupted also. Hence loading it directly into the data warehouse may damage it and rollback will be much more difficult. Therefore, this is one of the most important steps of ETL process</p>
<p><strong>Transform</strong>: In this stage, the extracted data is transformed into a format that is suitable for loading into the data warehouse. In this step, a set of rules or functions are applied on the extracted data to convert it into a single standard format. It may involve following processes/tasks:</p>
<ul>
<li><em>Filtering</em> – loading only certain attributes into the data warehouse.</li>
<li><em>Cleaning</em> – filling up the NULL values with some default values, mapping U.S.A, United States, and America into USA, etc.</li>
<li><em>Joining</em> – joining multiple attributes into one.</li>
<li><em>Splitting</em> – splitting a single attribute into multiple attributes.</li>
<li><em>Sorting</em> – sorting tuples on the basis of some attribute (generally key-attribute).</li>
</ul>
<p><strong>Load</strong>: After the data is transformed, it is loaded into the data warehouse. This step involves creating the physical data structures and loading the data into the warehouse. In this step, the transformed data is finally loaded into the data warehouse. Sometimes the data is updated by loading into the data warehouse very frequently and sometimes it is done after longer but regular intervals. The rate and period of loading solely depend on the requirements and varies from system to system.</p>
<blockquote>
<p>ETL is used if the whole process is outlet to a different organization, so the data is not directly loaded into the warehouse, rather it is kept in a staging area where is can be scrutinized for saftey issues and then loaded into the warehouse.
ELT is used if the company itself is handling all the work. Here the data is directly loaded into the warehouse and then transformed and stored in the warehouse.</p></blockquote>
<h2 id="data-warehouse-models">Data Warehouse Models<a hidden class="anchor" aria-hidden="true" href="#data-warehouse-models">#</a></h2>
<ol>
<li>
<p>Enterprise warehouse:</p>
<ul>
<li>An enterprise warehouse collects all of the information about subjects spanning the entire organization.</li>
<li>It provides corporate-wide data integration, usually from one or more operational systems or external information providers, and is cross-functional in scope.</li>
<li>It typically contains detailed data aswell as summarized data, and can range in size from a few gigabytes to hundreds of gigabytes, terabytes, or beyond.</li>
<li>An enterprise data warehouse may be implemented on traditional mainframes, computer superservers, or parallel architecture platforms. It requires extensive business modeling and may take years to design and build.</li>
</ul>
</li>
<li>
<p>Data mart:</p>
<ul>
<li>A data mart contains a subset of corporate-wide data that is of value to a specific group of users. The scope is confined to specific selected subjects. For example,a marketing data mart may confine its subjects to customer, item, and sales. The data contained in data marts tend to be summarized.</li>
<li>Data marts are usually implemented on low-cost departmental servers that are UNIX/LINUX or Windows-based. The implementation cycle of a data mart is more likely to be measured in weeks rather than months or years. However, it may involve complex integration in the long run if its design and planning were not enterprise-wide.</li>
<li>Depending on the source of data, data marts can be categorized as independent or dependent. Independent data marts are sourced from data captured from one or more operational systems or external information providers, or from data generated locally within a particular department or geographic area. Dependent data marts are sourced directly from enterprise data warehouses.</li>
</ul>
</li>
<li>
<p>Virtual warehouse:</p>
<ul>
<li>A virtual warehouse is a set of views over operational databases. For efficient query processing, only some of the possible summary views may be materialized.</li>
<li>A virtual warehouse is easy to build but requires excess capacity on operational database servers.</li>
</ul>
</li>
</ol>
<hr>
<p><strong>OLTP (Online Transaction Processing)</strong></p>
<p>Type of data processing that consists of executing a number of transactions occuring currently. Eg; Online banking, online shopping etc&hellip;</p>
<p><strong>OLAP (Online Analytical Processing)</strong></p>
<p>Software for performing multi-dimensional analysis at high speeds on large volumes of data from a data warehouse, data mart or some other unified , centralized data store.</p>
<table>
  <thead>
      <tr>
          <th>OLTP Systems</th>
          <th>OLAP Systems</th>
      </tr>
  </thead>
  <tbody>
      <tr>
          <td>Enable the real-time execution of large numbers of database transactions by large numbers of people.</td>
          <td>Usually involve querying many records (even all records) in a database for analytical purposes.</td>
      </tr>
      <tr>
          <td>Require lightning-fast response times</td>
          <td>Require response times that are orders of magnitude slower than those required by OLTP.</td>
      </tr>
      <tr>
          <td>Modify small amounts of data frequently and usually involve a balance of reads and writes.</td>
          <td>Do not modify data at all; workloads are usually read-intensive.</td>
      </tr>
      <tr>
          <td>Use indexed data to improve response times</td>
          <td>Store data in columnar format to allow easy access to large numbers of records.</td>
      </tr>
      <tr>
          <td>Require frequent or concurrent database backups</td>
          <td>Require far less frequent database backup.</td>
      </tr>
      <tr>
          <td>Require relatively little storage space</td>
          <td>Typically have significant storage space requirements because they store large amounts of historical data.</td>
      </tr>
      <tr>
          <td>Usually run simple queries involving just one or a few records</td>
          <td>Run complex queries involving large numbers of records.</td>
      </tr>
  </tbody>
</table>
<hr>
<h2 id="data-warehouse-schema">Data Warehouse Schema<a hidden class="anchor" aria-hidden="true" href="#data-warehouse-schema">#</a></h2>
<ol>
<li>Star Schema</li>
<li>Snowflake Schema</li>
<li>Fact Constellation Schema (Galaxy Schema)</li>
</ol>


  </div>

  <footer class="post-footer">
    <ul class="post-tags">
      <li><a href="balaji24092001/tags/cs/">CS</a></li>
    </ul>
  </footer>
</article>
    </main>
    
<footer class="footer">
        <span>&copy; 2025 <a href="balaji24092001/">BALAJI</a></span> · 

    <span>
        Powered by
        <a href="https://gohugo.io/" rel="noopener noreferrer" target="_blank">Hugo</a> &
        <a href="https://github.com/adityatelange/hugo-PaperMod/" rel="noopener" target="_blank">PaperMod</a>
    </span>
</footer>
<a href="#top" aria-label="go to top" title="Go to Top (Alt + G)" class="top-link" id="top-link" accesskey="g">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 12 6" fill="currentColor">
        <path d="M12 6H0l6-6z" />
    </svg>
</a>

<script>
    let menu = document.getElementById('menu')
    if (menu) {
        menu.scrollLeft = localStorage.getItem("menu-scroll-position");
        menu.onscroll = function () {
            localStorage.setItem("menu-scroll-position", menu.scrollLeft);
        }
    }

    document.querySelectorAll('a[href^="#"]').forEach(anchor => {
        anchor.addEventListener("click", function (e) {
            e.preventDefault();
            var id = this.getAttribute("href").substr(1);
            if (!window.matchMedia('(prefers-reduced-motion: reduce)').matches) {
                document.querySelector(`[id='${decodeURIComponent(id)}']`).scrollIntoView({
                    behavior: "smooth"
                });
            } else {
                document.querySelector(`[id='${decodeURIComponent(id)}']`).scrollIntoView();
            }
            if (id === "top") {
                history.replaceState(null, null, " ");
            } else {
                history.pushState(null, null, `#${id}`);
            }
        });
    });

</script>
<script>
    var mybutton = document.getElementById("top-link");
    window.onscroll = function () {
        if (document.body.scrollTop > 800 || document.documentElement.scrollTop > 800) {
            mybutton.style.visibility = "visible";
            mybutton.style.opacity = "1";
        } else {
            mybutton.style.visibility = "hidden";
            mybutton.style.opacity = "0";
        }
    };

</script>
<script>
    document.getElementById("theme-toggle").addEventListener("click", () => {
        if (document.body.className.includes("dark")) {
            document.body.classList.remove('dark');
            localStorage.setItem("pref-theme", 'light');
        } else {
            document.body.classList.add('dark');
            localStorage.setItem("pref-theme", 'dark');
        }
    })

</script>
<script>
    document.querySelectorAll('pre > code').forEach((codeblock) => {
        const container = codeblock.parentNode.parentNode;

        const copybutton = document.createElement('button');
        copybutton.classList.add('copy-code');
        copybutton.innerHTML = 'copy';

        function copyingDone() {
            copybutton.innerHTML = 'copied!';
            setTimeout(() => {
                copybutton.innerHTML = 'copy';
            }, 2000);
        }

        copybutton.addEventListener('click', (cb) => {
            if ('clipboard' in navigator) {
                navigator.clipboard.writeText(codeblock.textContent);
                copyingDone();
                return;
            }

            const range = document.createRange();
            range.selectNodeContents(codeblock);
            const selection = window.getSelection();
            selection.removeAllRanges();
            selection.addRange(range);
            try {
                document.execCommand('copy');
                copyingDone();
            } catch (e) { };
            selection.removeRange(range);
        });

        if (container.classList.contains("highlight")) {
            container.appendChild(copybutton);
        } else if (container.parentNode.firstChild == container) {
            
        } else if (codeblock.parentNode.parentNode.parentNode.parentNode.parentNode.nodeName == "TABLE") {
            
            codeblock.parentNode.parentNode.parentNode.parentNode.parentNode.appendChild(copybutton);
        } else {
            
            codeblock.parentNode.appendChild(copybutton);
        }
    });
</script>
</body>

</html>
